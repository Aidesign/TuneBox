var app=angular.module("TuneBox",["ngResource","ngRoute"]);app.config(["$routeProvider",function(o){o.when("/",{templateUrl:"partials/home.view.html",controller:"homeCtrl"}).when("/register",{templateUrl:"partials/register.view.html",controller:"registerCtrl"}).when("/login",{templateUrl:"partials/login.view.html",controller:"loginCtrl"}).when("/room",{templateUrl:"partials/room.html"}).when("/create-room",{templateUrl:"partials/create-room.html",controller:"roomcreationCtrl"}).when("/rooms",{templateUrl:"partials/rooms.html",controller:"roomlistingCtrl"}).otherwise({redirectTo:"/"})}]);(function(){angular.module("TuneBox").controller("homeCtrl",o);o.$inject=["$scope","authentication"];function o(o,e){}})();(function(){angular.module("TuneBox").controller("registerCtrl",o);o.$inject=["$scope","authentication","$location"];function o(o,e,n){if(e.isLoggedIn()){n.path("/")}o.register=function(){e.register(o.user).success(function(o){n.path("/")}).error(function(e){o.error=e})}}})();(function(){angular.module("TuneBox").service("authentication",o);o.$inject=["$window","$http"];function o(o,e){var n=function(e){o.localStorage["tunebox-token"]=e};var t=function(){return o.localStorage["tunebox-token"]};var r=function(){o.localStorage.removeItem("tunebox-token")};var i=function(o){return e.post("api/login",o).success(function(o){n(o.token)})};var c=function(o){return e.post("api/register",o).success(function(o){n(o.token)})};var l=function(){var e=t();if(e){var n=JSON.parse(o.atob(e.split(".")[1]));return n.exp>Date.now()/1e3}else{return null}};var u=function(){if(l()){var e=t();var n=JSON.parse(o.atob(e.split(".")[1]));return n}else{return false}};return{saveToken:n,getToken:t,logout:r,login:i,register:c,isLoggedIn:l,getUserInfo:u}}})();(function(){angular.module("TuneBox").controller("loginCtrl",o);o.$inject=["$scope","authentication","$location"];function o(o,e,n){if(e.isLoggedIn()){n.path("/")}o.error="";o.login=function(){e.login(o.user).success(function(o){n.path("/")}).error(function(e){o.error=e.message})}}})();(function(){angular.module("TuneBox").controller("navigationCtrl",o);o.$inject=["$scope","authentication"];function o(o,e){if(info=e.getUserInfo()){o.showLogin=false;o.test="Current user: "+info.email}else{o.showLogin=true}o.logout=function(){e.logout();o.test="logged out!";o.showLogin=true}}})();(function(){angular.module("TuneBox").controller("roomcreationCtrl",o);o.$inject=["$scope","authentication","$location","roomService"];function o(o,e,n,t){if(!e.isLoggedIn()){n.path("/")}o.createRoom=function(){var r=e.getUserInfo().email;o.room.admin=r;t.createRoom(o.room).success(function(o){n.path("/")}).error(function(o){console.log(o)})}}})();(function(){angular.module("TuneBox").controller("roomlistingCtrl",o);o.$inject=["$scope","authentication","$location","roomService"];function o(o,e,n,t){if(!e.isLoggedIn()){n.path("/")}var r=e.getUserInfo().email;t.getUserRooms(r).success(function(e){console.log(e);o.adminRooms=e});t.getPublicRooms().success(function(e){o.publicRooms=e})}})();(function(){angular.module("TuneBox").service("roomService",o);o.$inject=["$window","$http"];function o(o,e){var n=function(o){return e.post("api/createRoom",o).success(function(o){console.log(o)})};var t=function(o){console.log(o);return e.get("api/rooms/"+o).success(function(o){})};var r=function(){return e.get("api/rooms").success(function(o){})};return{createRoom:n,getUserRooms:t,getPublicRooms:r}}})();